<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <title>Bulletproof Commits</title>

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="http://pedrorijo91.github.io/assets/img/favicon.ico" />

        <!-- Come and get me RSS readers -->
        <link rel="alternate" type="application/rss+xml" title="Spaghetti and Hammers" href="http://pedrorijo91.github.io/feed.xml">

        <!-- Stylesheet -->
        <link rel="stylesheet" href="http://pedrorijo91.github.io/assets/css/style.css">
        <!--[if IE 8]><link rel="stylesheet" href="http://pedrorijo91.github.io/assets/css/ie.css"><![endif]-->

        <link rel="stylesheet" href="http://pedrorijo91.github.io/assets/css/font-awesome.min.css">

        <!-- Modernizr -->
        <script src="http://pedrorijo91.github.io/assets/js/modernizr.custom.15390.js" type="text/javascript"></script>

        <!-- Add jQuery and other scripts -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="http://pedrorijo91.github.io/assets/js/jquery-1.11.2.min.js"><\/script>')</script>
        <script src='http://pedrorijo91.github.io/assets/js/dropcap.min.js'></script>
        <script src='http://pedrorijo91.github.io/assets/js/responsive-nav.min.js'></script>
        <script src='http://pedrorijo91.github.io/assets/js/scripts.js'></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61168333-1', 'auto');
          ga('send', 'pageview');

        </script>
    </head>

    <body>
        <div class="header">
            <div class="container">
                <h1 class="logo"><a href="http://pedrorijo91.github.io">Spaghetti and Hammers</a></h1>
                <nav class="nav-collapse">
                    <ul class="noList">
                    
                        <li class="element first  ">
                            <a href="http://pedrorijo91.github.io/index.html">Home</a>
                        </li>
                    
                        <li class="element   last">
                            <a href="http://pedrorijo91.github.io/about.html">About</a>
                        </li>
                    
                    </ul>
                </nav>
            </div>
        </div><!-- end .header -->


	<div class="content">
		<div class="container">
			<div class="post">
	
	<h1 class="postTitle">Bulletproof Commits</h1>
	<p class="meta">April 28, 2015 | <span class="time">3</span> Minute Read | <a href="/blog/bulletproof-commits/index.html#disqus_thread" data-disqus-identifier="/blog/bulletproof-commits/"></a></p>

	<div class="post-body">
	<p><span class="dropcap">H</span>ave you ever committed code that made you feel ashamed? Maybe, for instance, a print statement you used for debugging just because you were too lazy to use the debugger? Maybe you even had that crazy idea of using a <em>not so pretty</em> print message? (Don&#39;t worry, we all felt desperate to that point.)</p>

<p>If the project you are working on has strong code review practices then, those print statements should get caught before going to production. Nevertheless, the code review process may let pass those pieces of code undetected when the diff set gets too large and there may be some time constraints.</p>

<p>One simple solution is to review your own code before committing. How? I&#39;ve found out recently a very useful feature on git, the <em>&#39;git add -p&#39;</em> command (if you use some git client I don&#39;t know how to use this feature, but there&#39;s probably an equivalent functionality). 
This command allows you to &quot;interactively choose hunks of patch between the index and the work tree and add them to the index&quot;<sup><a href="http://git-scm.com/docs/git-add">1</a></sup>, giving you a chance to review the difference before adding modified contents to the index.</p>

<p>But who has the patience to review every chunk of code carefully? Well, maybe no one?</p>

<p><a href="https://github.com/pedrorijo91/commit4dummies">Commit 4 dummies</a> is a side project I&#39;ve developed to help me detecting junk code before committing it. It is based on another git feature that allows you to automate such code revision: <a href="http://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Git Hooks</a>.</p>

<p align='center'><img src='/assets/img/screencapture-commit4dummies.png' alt='commit4dummies' title='Commit 4 dummies project' width='800px'/></p>

<p>Git Hooks are custom scripts that run on specific events, and there are two groups:</p>

<ul>
<li><a href="http://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks#Client-Side-Hooks">Client-side hooks</a>, triggered by operations like committing and merging.</li>
<li><a href="http://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks#Server-Side-Hooks">Server-side hooks</a>, which run on network operations, such as receiving pushed commits. <a href="https://travis-ci.org/">Travis</a>, <a href="https://www.atlassian.com/software/jira">Jira</a> and many other code services are based on server-side hooks, also known as webhooks.</li>
</ul>

<p>In the <a href="http://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">documentation</a> you can learn about the several client-side and server-side hooks. For the purpose of reviewing committing code we focus on <em>&#39;pre-commit&#39;</em> hooks. As declared in the documentation, &quot;The pre-commit hook is run first, before you even type in a commit message&quot;, meaning it&#39;s the perfect tool for our goal.</p>

<p>So, how is this hook implemented? The basic idea is to make a <em>&#39;grep&#39;</em> search through the diff set for some words that should be defined in the <em>&#39;keywords.conf&#39;</em> file. This file is a simple text file, containing, in each line, the file extension and the words to look for. Take a look in this simple <a href="https://github.com/pedrorijo91/commit4dummies/blob/master/keywords.conf">example</a>. This file allows anyone to configure the hook to its own needs without much effort.</p>

<p>Some worthy details:</p>

<ul>
<li>The <em>&#39;grep&#39;</em> search does not looks for the exact word, meaning that looking for <em>&#39;print&#39;</em> could match with <em>&#39;println&#39;</em>.</li>
<li>This hook assumes that you are only looking in the last diff set, meaning that if you are applying the hook to an ongoing project then you should probably make a manual <em>&#39;grep&#39;</em> search yourself.</li>
<li>Only added on edited files in the staging area are considered: removed files are ignored.</li>
<li>A <em>&#39;git stash&#39;</em> and <em>&#39;git stash pop&#39;</em> commands are executed to match against staged version of the file, otherwise you could be matching against a version different from the one committing (this operation should be transparent for the developer). This feature differs this hook from most of the available on the web, since this details is usually forgotten.</li>
<li>For each match the user is prompted for continuation/abortion, because it may exist some false positives.</li>
<li>Some coloured feedback is printed to the console</li>
</ul>

<blockquote>
<p>Note: 
You can always skip you client-side hooks with <em>&#39;git commit --no-verify&#39;</em></p>
</blockquote>

	</div>

	<a href="https://twitter.com/share" class="twitter-share-button" data-via="pedrorijo91" data-size="large">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

	<!-- POST NAVIGATION -->
	<div class="postNav clearfix">
	  
	    <a class="prev image" href="http://pedrorijo91.github.io/blog/github-stars/"><span>&laquo; Github Stars</span>
	    
	    	<img src="http://pedrorijo91.github.io/assets/img/hollywod_walk_of_fame.jpg" alt="">
	    
		</a>
	  
	  
	    <a class="next image" href="http://pedrorijo91.github.io/blog/seven-languages-seven-weeks/"><span>Seven Languages in Seven Weeks - Book review &raquo;</span>
	    
	    	<img src="http://pedrorijo91.github.io/assets/img/Nerd-reading.jpg" alt="">
	  	
	  	</a>
	  
	</div>

	<div id="disqus_thread"></div>
	  <script type="text/javascript">
	      var disqus_shortname = 'pedrorijo91';
				var disqus_identifier = "/blog/bulletproof-commits/";
	      (function() {
	          var dsq = document.createElement('script');
						dsq.type = 'text/javascript';
						dsq.async = true;
	          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	      })();
	  </script>
	  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>

		</div>
	</div>
	<!-- end .content -->

          <div class="footer">
            <div class="container">
              <p class="copy">Copyright &copy; 2015 pedrorijo91</p>

              <div class="footer-links">
                <ul class="noList">
                  <li><a href="/feed.xml">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-rss fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="https://twitter.com/pedrorijo91">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-twitter fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="https://github.com/pedrorijo91">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-github fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="https://bitbucket.org/pedrorijo91">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-bitbucket fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="https://news.ycombinator.com/user?id=pedrorijo91">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-square-o fa-stack-2x"></i>
                    <i class="fa fa-hacker-news fa-stack-1x"></i>
                  </span>
                  </a></li>
                  <li><a href="http://stackoverflow.com/users/4398050/pedrorijo91">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-square-o fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x"></i>
                  </span>
                  </a></li>
                  <li><a href="https://www.linkedin.com/in/pedrorijo91">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-linkedin fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="skype:pedrorij91?add">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-skype fa-stack-1x"></i>
                    </span>
                  </a></li>
                  <li><a href="mailto:pedrorijo91@gmail.com">
                    <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-envelope fa-stack-1x"></i>
                    </span>
                  </a></li>
                </ul>
              </div>
            </div>
          </div><!-- end .footer -->

    </body>
</html>


<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'pedrorijo91'; // required: replace example with your forum shortname
			var disqus_identifier = "/blog/bulletproof-commits/";
			(function () {
				var s = document.createElement('script');
				s.async = true;
				s.type = 'text/javascript';
				s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>
